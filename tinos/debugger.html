<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AiOS Debugger - Data Editor</title>
    <style>
        :root {
            --primary-color: #f39c12;
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-color: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        /* å¯†ç¢¼é–ä»‹é¢ */
        #authOverlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        /* ä¸»èª¿è©¦ä»‹é¢ */
        #debugContent {
            display: none;
            width: 90%;
            max-width: 600px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h2 { color: var(--primary-color); text-align: center; margin-bottom: 20px; }

        .data-section {
            margin-bottom: 15px;
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }

        .data-label {
            font-size: 14px;
            font-weight: bold;
            color: #aaa;
            display: block;
            margin-bottom: 5px;
        }

        textarea {
            width: 100%;
            background: #111;
            color: #0f0;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 8px;
            font-family: monospace;
            resize: vertical;
            box-sizing: border-box;
        }

        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        button {
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }

        .btn-apply { background: #27ae60; color: white; }
        .btn-reset { background: #e67e22; color: white; }
        .btn-respring { background: #c0392b; color: white; }
        
        button:hover { opacity: 0.8; }

        input[type="password"] {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--primary-color);
            background: #333;
            color: white;
            text-align: center;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

    <div id="authOverlay">
        <h2 style="color: white;">AiOS å®‰å…¨é©—è­‰</h2>
        <input type="password" id="debugPass" placeholder="è¼¸å…¥ Debug å¯†ç¢¼">
        <button onclick="checkAuth()" style="background: var(--primary-color); width: 150px;">é©—è­‰</button>
        <p id="authError" style="color: #ff4d4d; margin-top: 10px;"></p>
    </div>

    <div id="debugContent">
        <h2>ğŸ› ï¸ ç³»çµ±æ•¸æ“šèª¿è©¦å™¨</h2>
        
        <div id="editorContainer">
            </div>

        <div class="button-group">
            <button class="btn-reset" onclick="refreshEditor()">ğŸ”„ é‡è¨­</button>
            <button class="btn-apply" onclick="applyChanges()">ğŸ’¾ å¥—ç”¨</button>
            <button class="btn-respring" onclick="respring()">âš¡ é‡åˆ· (Respring)</button>
        </div>
    </div>

    <script>
        // ä½ åœ¨ script.js ä¸­å®šç¾©éçš„æš«å­˜ Keys
        const STORAGE_KEYS = [
            'userPasscode',
            'installedApps',
            'currentTheme',
            'homeWallpaper',
            'lockWallpaper',
            'screensaverPattern',
            'screensaverTimeout'
        ];

        function checkAuth() {
            const pass = document.getElementById('debugPass').value;
            // é€™è£¡ä¿ç•™åŸæœ¬çš„é‚è¼¯ï¼Œæˆ–è€…æ˜¯æª¢æŸ¥ç³»çµ±å¯†ç¢¼
            const systemPass = localStorage.getItem('userPasscode') || '1234';
            
            if (pass === systemPass || pass === '0000') { // å‡è¨­ 0000 ç‚ºå¾Œå‚™è¬ç”¨ç¢¼
                document.getElementById('authOverlay').style.display = 'none';
                document.getElementById('debugContent').style.display = 'block';
                refreshEditor();
            } else {
                document.getElementById('authError').textContent = 'å¯†ç¢¼éŒ¯èª¤ï¼Œæ‹’çµ•å­˜å–';
            }
        }

        // åˆå§‹åŒ–ç·¨è¼¯å™¨å…§å®¹ (é‡è¨­åŠŸèƒ½ä¹Ÿèª¿ç”¨æ­¤è™•)
        function refreshEditor() {
            const container = document.getElementById('editorContainer');
            container.innerHTML = '';

            STORAGE_KEYS.forEach(key => {
                const value = localStorage.getItem(key) || '';
                
                const section = document.createElement('div');
                section.className = 'data-section';
                section.innerHTML = `
                    <label class="data-label">Key: ${key}</label>
                    <textarea id="input-${key}" rows="3">${value}</textarea>
                `;
                container.appendChild(section);
            });
            console.log("æ•¸æ“šå·²é‡è¨­ç‚ºç•¶å‰æš«å­˜ç‹€æ…‹");
        }

        // å¥—ç”¨ä¿®æ”¹åˆ° localStorage
        function applyChanges() {
            if (!confirm('ç¢ºå®šè¦å–ä»£åŸæœ¬çš„æš«å­˜æ•¸æ“šå—ï¼Ÿé€™å¯èƒ½æœƒå½±éŸ¿ç³»çµ±ç©©å®šæ€§ã€‚')) return;

            STORAGE_KEYS.forEach(key => {
                const newValue = document.getElementById(`input-${key}`).value;
                localStorage.setItem(key, newValue);
            });

            alert('æ•¸æ“šå·²æˆåŠŸå¥—ç”¨ï¼');
        }

        // é‡åˆ·åŠŸèƒ½
        function respring() {
            if (confirm('ç³»çµ±å°‡æœƒé‡æ–°è¼‰å…¥ (Respring)ï¼Œæ‰€æœ‰æœªå„²å­˜çš„é€²åº¦å°‡æœƒéºå¤±ã€‚')) {
                window.location.href = './install.html';
            }
        }
    </script>
</body>
</html>
